
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>5.1.1. Distinction of solid liquid atoms and clustering &#8212; pyscal</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://pyscal.org/part3/05_distinguishing_solid_liquid.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. Angular criteria for identification of diamond structure" href="../part4/angular.html" />
    <link rel="prev" title="5. Classification of atoms as solid or liquid" href="solidliquid.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://pyscal.org/part3/05_distinguishing_solid_liquid.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Distinction of solid liquid atoms and clustering" />
<meta property="og:description" content="Distinction of solid liquid atoms and clustering  In this example, we will take one snapshot from a molecular dynamics simulation which has a solid cluster in l" />
<meta property="og:image"       content="https://pyscal.org/_static/logo.png" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">pyscal</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   pyscal - python Structural Environment Calculator
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Examples
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../part1/01_getting_started.html">
   1. Getting started with pyscal
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../part2/intro.html">
   2. Methods to calculate neighbors of a particle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="steinhardt.html">
   3. Steinhardtâ€™s parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="disorder.html">
   4. Disorder parameter
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="solidliquid.html">
   5. Classification of atoms as solid or liquid
  </a>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     5.1.1. Distinction of solid liquid atoms and clustering
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#clustering-based-on-a-custom-property">
     5.1.2. Clustering based on a custom property
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../part4/angular.html">
   6. Angular criteria for identification of diamond structure
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../part4/angular.html#chi-parameters-for-structural-identification">
   7.
   <span class="math notranslate nohighlight">
    \(\chi\)
   </span>
   parameters for structural identification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../part4/angular.html#references">
   8. References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../part5/voronoiparameters.html">
   9. Voronoi tessellation to identify local structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../part7/entropy_parameters.html">
   10. Entropy - Enthalpy parameters
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../part8/10_short_range_order.html">
   11. Cowley short range order parameter
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/part3/05_distinguishing_solid_liquid.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/srmnitc/pyscal-webpage"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/srmnitc/pyscal-webpage/issues/new?title=Issue%20on%20page%20%2Fpart3/05_distinguishing_solid_liquid.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/srmnitc/pyscal-webpage/master?urlpath=lab/tree/pyscal/part3/05_distinguishing_solid_liquid.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/srmnitc/pyscal-webpage/blob/master/pyscal/part3/05_distinguishing_solid_liquid.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   5.1.1. Distinction of solid liquid atoms and clustering
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#clustering-algorithm">
     5.1.1.1. Clustering algorithm
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#clustering-based-on-a-custom-property">
   5.1.2. Clustering based on a custom property
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="distinction-of-solid-liquid-atoms-and-clustering">
<h1><span class="section-number">5.1.1. </span>Distinction of solid liquid atoms and clustering<a class="headerlink" href="#distinction-of-solid-liquid-atoms-and-clustering" title="Permalink to this headline">Â¶</a></h1>
<p>In this example, we will take one snapshot from a molecular dynamics simulation which has a solid cluster in liquid. The task is to identify solid atoms and cluster them. More details about the method can be found <a class="reference external" href="https://pyscal.readthedocs.io/en/latest/solidliquid.html">here</a>.</p>
<p>The first step is, of course, importing all the necessary module. For visualisation, we will use <a class="reference external" href="https://www.ovito.org/">Ovito</a>.</p>
<p><img alt="alt text" src="part3/../docs/source/system1.png" /></p>
<p>The above image shows a visualisation of the system using Ovito. Importing modules,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyscal.core</span> <span class="k">as</span> <span class="nn">pc</span>
</pre></div>
</div>
</div>
</div>
<p>Now we will set up a System with this input file, and calculate neighbors. Here we will use a cutoff method to find neighbors. More details about finding neighbors can be found <a class="reference external" href="https://pyscal.readthedocs.io/en/latest/nearestneighbormethods.html">here</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="p">()</span>
<span class="n">sys</span><span class="o">.</span><span class="n">read_inputfile</span><span class="p">(</span><span class="s1">&#39;cluster.dump&#39;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">find_neighbors</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;cutoff&#39;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mf">3.63</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Once we compute the neighbors, the next step is to find solid atoms. This can be done using <code class="docutils literal notranslate"><span class="pre">System.find_solids</span></code> method. There are few parameters that can be set, which can be found in detail here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">find_solids</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">avgthreshold</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">cluster</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The above statement found all the solid atoms. Solid atoms can be identified by the value of the <code class="docutils literal notranslate"><span class="pre">solid</span></code> attribute. For that we first get the atom objects and select those with <code class="docutils literal notranslate"><span class="pre">solid</span></code> value as True.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">atoms</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">atoms</span>
<span class="n">solids</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span> <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">solid</span><span class="p">]</span>
<span class="nb">len</span><span class="p">(</span><span class="n">solids</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>202
</pre></div>
</div>
</div>
</div>
<p>There are 202 solid atoms in the system. In order to visualise in Ovito, we need to first write it out to a trajectory file. This can be done with the help of <code class="docutils literal notranslate"><span class="pre">to_file</span></code> method of System. This method can help to save any attribute of the atom or ant Steinhardt parameter value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s1">&#39;sys.solid.dat&#39;</span><span class="p">,</span> <span class="n">custom</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;solid&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>We can now visualise this file in Ovito. After opening the file in Ovito, the modifier <a class="reference external" href="https://ovito.org/manual/particles.modifiers.compute_property.html">compute property</a> can be selected. The <code class="docutils literal notranslate"><span class="pre">Output</span> <span class="pre">property</span></code> should be <code class="docutils literal notranslate"><span class="pre">selection</span></code> and in the expression field, <code class="docutils literal notranslate"><span class="pre">solid==0</span></code> can be selected to select all the non solid atoms. Applying a modifier <a class="reference external" href="https://ovito.org/manual/particles.modifiers.delete_selected_particles.html">delete selected particles</a> can be applied to delete all the non solid particles. The system after removing all the liquid atoms is shown below.</p>
<p><img alt="alt text" src="part3/../docs/source/system2.png" /></p>
<div class="section" id="clustering-algorithm">
<h2><span class="section-number">5.1.1.1. </span>Clustering algorithm<a class="headerlink" href="#clustering-algorithm" title="Permalink to this headline">Â¶</a></h2>
<p>You can see that there is a cluster of atom. The clustering functions that pyscal offers helps in this regard. If you used <code class="docutils literal notranslate"><span class="pre">find_clusters</span></code> with <code class="docutils literal notranslate"><span class="pre">cluster=True</span></code>, the clustering is carried out. Since we did used <code class="docutils literal notranslate"><span class="pre">cluster=False</span></code> above, we will rerun the function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">find_solids</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">avgthreshold</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">cluster</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>176
</pre></div>
</div>
</div>
</div>
<p>You can see that the above function call returned the number of atoms belonging to the largest cluster as an output. In order to extract atoms that belong to the largest cluster, we can use the <code class="docutils literal notranslate"><span class="pre">largest_cluster</span></code> attribute of the atom.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">atoms</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">atoms</span>
<span class="n">largest_cluster</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span> <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">largest_cluster</span><span class="p">]</span>
<span class="nb">len</span><span class="p">(</span><span class="n">largest_cluster</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>176
</pre></div>
</div>
</div>
</div>
<p>The value matches that given by the function. Once again we will save this information to a file and visualise it in Ovito.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s1">&#39;sys.cluster.dat&#39;</span><span class="p">,</span> <span class="n">custom</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> <span class="s1">&#39;largest_cluster&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>The system visualised in Ovito following similar steps as above is shown below.</p>
<p><img alt="alt text" src="part3/../docs/source/system3.png" /></p>
<p>It is clear from the image that the largest cluster of solid atoms was successfully identified. Clustering can be done over any property. The following example with the same system will illustrate this.</p>
</div>
</div>
<div class="section" id="clustering-based-on-a-custom-property">
<h1><span class="section-number">5.1.2. </span>Clustering based on a custom property<a class="headerlink" href="#clustering-based-on-a-custom-property" title="Permalink to this headline">Â¶</a></h1>
<p>In pyscal, clustering can be done based on any property. The following example illustrates this. To find the clusters based on a custom property, the <code class="docutils literal notranslate"><span class="pre">System.clusters_atoms</span></code> method has to be used. The simulation box shown above has the centre roughly at (25, 25, 25). For the custom clustering, we will cluster all atoms within a distance of 10 from the the rough centre of the box at (25, 25, 25). Let us define a function that checks the above condition.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_distance</span><span class="p">(</span><span class="n">atom</span><span class="p">):</span>
    <span class="c1">#get position of atom</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">pos</span>
    <span class="c1">#calculate distance from (25, 25, 25)</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="p">((</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">25</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">25</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">25</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="c1">#check if dist &lt; 10</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">dist</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The above function would return True or False depending on a condition and takes the Atom as an argument. These are the two important conditions to be satisfied. Now we can pass this function to cluster. First, set up the system and find the neighbors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="p">()</span>
<span class="n">sys</span><span class="o">.</span><span class="n">read_inputfile</span><span class="p">(</span><span class="s1">&#39;cluster.dump&#39;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">find_neighbors</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;cutoff&#39;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mf">3.63</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now cluster</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">cluster_atoms</span><span class="p">(</span><span class="n">check_distance</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>242
</pre></div>
</div>
</div>
</div>
<p>There are 242 atoms in the cluster! Once again we can check this, save to a file and visualise in ovito.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">atoms</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">atoms</span>
<span class="n">largest_cluster</span> <span class="o">=</span> <span class="p">[</span><span class="n">atom</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span> <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">largest_cluster</span><span class="p">]</span>
<span class="nb">len</span><span class="p">(</span><span class="n">largest_cluster</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>242
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">to_file</span><span class="p">(</span><span class="s1">&#39;sys.dist.dat&#39;</span><span class="p">,</span> <span class="n">custom</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> <span class="s1">&#39;largest_cluster&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="alt text" src="part3/../docs/source/system4.png" /></p>
<p>This example illustrates that any property can be used to cluster the atoms!</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "lammps"
        },
        kernelOptions: {
            kernelName: "lammps",
            path: "./part3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'lammps'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="solidliquid.html" title="previous page"><span class="section-number">5. </span>Classification of atoms as solid or liquid</a>
    <a class='right-next' id="next-link" href="../part4/angular.html" title="next page"><span class="section-number">6. </span>Angular criteria for identification of diamond structure</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Sarath Menon, Grisell DÃ­az Leines, Jutta Rogal<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>